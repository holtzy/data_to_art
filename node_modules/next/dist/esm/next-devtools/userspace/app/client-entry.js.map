{"version":3,"sources":["../../../../src/next-devtools/userspace/app/client-entry.tsx"],"sourcesContent":["import React from 'react'\nimport { getSocketUrl } from '../../../client/dev/hot-reloader/get-socket-url'\nimport { HMR_ACTIONS_SENT_TO_BROWSER } from '../../../server/dev/hot-reloader-types'\nimport DefaultGlobalError from '../../../client/components/builtin/global-error'\nimport { AppDevOverlayErrorBoundary } from './app-dev-overlay-error-boundary'\n\n// if an error is thrown while rendering an RSC stream, this will catch it in dev\n// and show the error overlay\nexport function createRootLevelDevOverlayElement(reactEl: React.ReactElement) {\n  const socketUrl = getSocketUrl(process.env.__NEXT_ASSET_PREFIX || '')\n  const socket = new window.WebSocket(`${socketUrl}/_next/webpack-hmr`)\n\n  // add minimal \"hot reload\" support for RSC errors\n  const handler = (event: MessageEvent) => {\n    let obj\n    try {\n      obj = JSON.parse(event.data)\n    } catch {}\n\n    if (!obj || !('action' in obj)) {\n      return\n    }\n\n    if (obj.action === HMR_ACTIONS_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES) {\n      window.location.reload()\n    }\n  }\n\n  socket.addEventListener('message', handler)\n\n  return (\n    <AppDevOverlayErrorBoundary globalError={[DefaultGlobalError, null]}>\n      {reactEl}\n    </AppDevOverlayErrorBoundary>\n  )\n}\n"],"names":["React","getSocketUrl","HMR_ACTIONS_SENT_TO_BROWSER","DefaultGlobalError","AppDevOverlayErrorBoundary","createRootLevelDevOverlayElement","reactEl","socketUrl","process","env","__NEXT_ASSET_PREFIX","socket","window","WebSocket","handler","event","obj","JSON","parse","data","action","SERVER_COMPONENT_CHANGES","location","reload","addEventListener","globalError"],"mappings":";AAAA,OAAOA,WAAW,QAAO;AACzB,SAASC,YAAY,QAAQ,kDAAiD;AAC9E,SAASC,2BAA2B,QAAQ,yCAAwC;AACpF,OAAOC,wBAAwB,kDAAiD;AAChF,SAASC,0BAA0B,QAAQ,mCAAkC;AAE7E,iFAAiF;AACjF,6BAA6B;AAC7B,OAAO,SAASC,iCAAiCC,OAA2B;IAC1E,MAAMC,YAAYN,aAAaO,QAAQC,GAAG,CAACC,mBAAmB,IAAI;IAClE,MAAMC,SAAS,IAAIC,OAAOC,SAAS,CAAC,AAAC,KAAEN,YAAU;IAEjD,kDAAkD;IAClD,MAAMO,UAAU,CAACC;QACf,IAAIC;QACJ,IAAI;YACFA,MAAMC,KAAKC,KAAK,CAACH,MAAMI,IAAI;QAC7B,EAAE,UAAM,CAAC;QAET,IAAI,CAACH,OAAO,CAAE,CAAA,YAAYA,GAAE,GAAI;YAC9B;QACF;QAEA,IAAIA,IAAII,MAAM,KAAKlB,4BAA4BmB,wBAAwB,EAAE;YACvET,OAAOU,QAAQ,CAACC,MAAM;QACxB;IACF;IAEAZ,OAAOa,gBAAgB,CAAC,WAAWV;IAEnC,qBACE,KAACV;QAA2BqB,aAAa;YAACtB;YAAoB;SAAK;kBAChEG;;AAGP","ignoreList":[0]}