{"version":3,"sources":["../../../../../src/next-devtools/userspace/app/errors/stitched-error.ts"],"sourcesContent":["import React from 'react'\nimport isError from '../../../../lib/is-error'\n\nconst ownerStacks = new WeakMap<Error, string | null>()\nconst componentStacks = new WeakMap<Error, string>()\n\nexport function getComponentStack(error: Error): string | undefined {\n  return componentStacks.get(error)\n}\nexport function setComponentStack(error: Error, stack: string) {\n  componentStacks.set(error, stack)\n}\n\nexport function getOwnerStack(error: Error): string | null | undefined {\n  return ownerStacks.get(error)\n}\nexport function setOwnerStack(error: Error, stack: string | null) {\n  ownerStacks.set(error, stack)\n}\n\nexport function coerceError(value: unknown): Error {\n  return isError(value) ? value : new Error('' + value)\n}\n\nexport function setOwnerStackIfAvailable(error: Error): void {\n  // React 18 and prod does not have `captureOwnerStack`\n  if ('captureOwnerStack' in React) {\n    setOwnerStack(error, React.captureOwnerStack())\n  }\n}\n\nexport function decorateDevError(\n  thrownValue: unknown,\n  errorInfo: React.ErrorInfo\n) {\n  const error = coerceError(thrownValue)\n  setOwnerStackIfAvailable(error)\n  // TODO: change to passing down errorInfo later\n  // In development mode, pass along the component stack to the error\n  if (errorInfo.componentStack) {\n    setComponentStack(error, errorInfo.componentStack)\n  }\n  return error\n}\n"],"names":["coerceError","decorateDevError","getComponentStack","getOwnerStack","setComponentStack","setOwnerStack","setOwnerStackIfAvailable","ownerStacks","WeakMap","componentStacks","error","get","stack","set","value","isError","Error","React","captureOwnerStack","thrownValue","errorInfo","componentStack"],"mappings":";;;;;;;;;;;;;;;;;;;;IAoBgBA,WAAW;eAAXA;;IAWAC,gBAAgB;eAAhBA;;IAzBAC,iBAAiB;eAAjBA;;IAOAC,aAAa;eAAbA;;IAJAC,iBAAiB;eAAjBA;;IAOAC,aAAa;eAAbA;;IAQAC,wBAAwB;eAAxBA;;;;gEAxBE;kEACE;AAEpB,MAAMC,cAAc,IAAIC;AACxB,MAAMC,kBAAkB,IAAID;AAErB,SAASN,kBAAkBQ,KAAY;IAC5C,OAAOD,gBAAgBE,GAAG,CAACD;AAC7B;AACO,SAASN,kBAAkBM,KAAY,EAAEE,KAAa;IAC3DH,gBAAgBI,GAAG,CAACH,OAAOE;AAC7B;AAEO,SAAST,cAAcO,KAAY;IACxC,OAAOH,YAAYI,GAAG,CAACD;AACzB;AACO,SAASL,cAAcK,KAAY,EAAEE,KAAoB;IAC9DL,YAAYM,GAAG,CAACH,OAAOE;AACzB;AAEO,SAASZ,YAAYc,KAAc;IACxC,OAAOC,IAAAA,gBAAO,EAACD,SAASA,QAAQ,qBAAqB,CAArB,IAAIE,MAAM,KAAKF,QAAf,qBAAA;eAAA;oBAAA;sBAAA;IAAoB;AACtD;AAEO,SAASR,yBAAyBI,KAAY;IACnD,sDAAsD;IACtD,IAAI,uBAAuBO,cAAK,EAAE;QAChCZ,cAAcK,OAAOO,cAAK,CAACC,iBAAiB;IAC9C;AACF;AAEO,SAASjB,iBACdkB,WAAoB,EACpBC,SAA0B;IAE1B,MAAMV,QAAQV,YAAYmB;IAC1Bb,yBAAyBI;IACzB,+CAA+C;IAC/C,mEAAmE;IACnE,IAAIU,UAAUC,cAAc,EAAE;QAC5BjB,kBAAkBM,OAAOU,UAAUC,cAAc;IACnD;IACA,OAAOX;AACT","ignoreList":[0]}